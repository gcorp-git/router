!function(){"use strict";const t={isInited:!1,allowedOptions:{processLinks:"boolean",getState:"function",onVisit:"function"}},e={processLinks:!0,getState:t=>{},onVisit:({location:t,state:e})=>{}};class n{constructor(t){const e=()=>{throw"incorrect routes format"};t instanceof Array||e(),this.default=void 0;const n=[];for(const o of t){o instanceof Array||e(),o.length||e();const t=o[0];"string"!=typeof t&&e();const i=o.length>1?o[1]:void 0,s=o.length>2?o[2]:{};if(s instanceof Object||e(),""===t){this.default&&e(),this.default=i;continue}const a=[],c=r(t,a),f=[];if(s.params instanceof Object)for(const t in s.params)f.push([t,r(s.params[t],a)]);let l="";s.hash&&(l=r(s.hash,a)),n.push({path:c,state:i,params:f,hash:l})}return this.list=n,function t(e){Object.freeze(e);if(void 0===e)return e;Object.getOwnPropertyNames(e).forEach(n=>{null===e[n]||"object"!=typeof e[n]&&"function"!=typeof e[n]||Object.isFrozen(e[n])||t(e[n])});return e}(this)}}window.Routes=n;function o(t){if(!e.processLinks)return;let n=null;for(const e of t.path)if("A"===e.tagName){n=e;break}if(!n)return;if("ignore"===n.getAttribute("data-router"))return;const o=i(n.getAttribute("href"));o instanceof Object&&(t.preventDefault(),s(o))}function i(t){if(void 0===(t=function(t){0===(t=t.trim()).indexOf("//")&&(t=location.protocol+t),0===t.indexOf(location.origin)&&(t=t.substr(location.origin.length));try{if(new URL(t).origin!==location.origin)return}catch(t){}switch(!0){case 0===t.indexOf("/"):break;case 0===t.indexOf("#"):t=location.pathname+location.search+t;break;case 0===t.indexOf("?"):t=location.pathname+t;break;default:{const e=location.pathname.lastIndexOf("/");t=(-1!==e?location.pathname.substr(0,e+1):"")+t}}return t}(t)))return;const n=e.getState(t);if(void 0!==n){if(!(n instanceof Object))throw"getState() returned incorrect result";return{state:n,url:t}}}function s({state:t,url:n}){if(!(t instanceof Object))throw"state should be an object";window.history.pushState(t,document.title,n),e.onVisit(window.history.state)}function r(t,e){const n=/^[^\d\W]\w*$/,o=[];let i=!1,s="";for(let r=0,a=t.length;r<a;r++){const c=t[r];if("{"===c){(i||r===a-1)&&die(),i=!0;continue}if(!i){"}"===c&&die(),s+=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");continue}let f="";for(let c=r;c<a;c++){const l=t[c];if("{"===l&&die(),c===a-1&&"}"!==l&&die(),"}"===l){s+="([^/?#&]+)",(f=f.trim())||die(),n.test(f)||die(),-1!==e.indexOf(f)&&die(),e.push(f),o.push(f),i=!1,r=c;break}f+=l}}return{regexp:new RegExp("^"+s+"$","g"),names:o}}function a(t,e,n){let o=[...t.matchAll(e.regexp)];if(!o.length||!o[0].length)return!1;const i=o[0].slice(1);for(let t=0,o=i.length;t<o;t++)n[e.names[t]]=i[t];return!0}window.router=new class{init(n){t.isInited||(t.isInited=!0,this.setOptions(n),document.addEventListener("click",o),window.onpopstate=(t=>e.onVisit(t.state)),this.visit(document.location.href))}setOptions(n){if(n instanceof Object)for(const o in t.allowedOptions)if(void 0!==n[o]){const i=t.allowedOptions[o];if(typeof n[o]!==i)throw"incorrect options format";e[o]=n[o]}}visit(t){if("string"!=typeof t)throw"incorrect URL format";const e=i(t);e instanceof Object&&s(e)}getRoute(t,e){if(!(e instanceof n))throw"incorrect routes format";let o=e.default;for(const n of e.list){const e=new URL(location.origin+t),i={};if(a(e.pathname,n.path,i)){for(let t=0,o=n.params.length;t<o;t++){const o=n.params[t],s=e.searchParams.get(o[0]);null!==s&&a(s,o[1],i)}n.hash&&a(e.hash.substr(1),n.hash,i),o={...n.state,...i};break}}return o}}}();